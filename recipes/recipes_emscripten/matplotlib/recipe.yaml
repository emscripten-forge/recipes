context:
  name: matplotlib
  version: 3.10.8

source:
- url: https://github.com/matplotlib/matplotlib/archive/v${{ version }}.tar.gz
  sha256: dbc50c7b15bb8d7dbe51a27a58322ed73f09291772d9e3184f03f11c576693f7
  patches:
  - patches/fix-threading-and-font-cache.patch
  - patches/static-cast.patch

build:
  number: 0

outputs:
- package:
    name: matplotlib-base
    version: ${{ version }}
  build:
    script: build-base.sh
  requirements:
    build:
    - python
    - pip
    - cross-python_${{ target_platform }}

    - ${{ compiler('c') }}
    - ${{ compiler('cxx') }}
    - pkg-config
    - meson-python
    - numpy
    - setuptools_scm_git_archive

      # to template the emscripten.meson.cross file
    - sed

    host:
    - python
    - numpy
    - pybind11
    - freetype
    - qhull
    run:
    - contourpy
    - cycler
    - fonttools
    - kiwisolver
    - numpy
    - packaging
    - pillow
    - pyparsing
    - python-dateutil
    - pytz
  tests:
  - script: pytester
    files:
      recipe:
      - test_import_matplotlib.py
    requirements:
      build:
      - pytester
      run:
      - pytester-run

- package:
    name: matplotlib
    version: ${{ version }}

  requirements:
    host:
    - python
    run:
    - python
    - ${{ pin_subpackage('matplotlib-base', exact=True) }}

  tests:
  - script: pytester
    files:
      recipe:
      - test_import_matplotlib.py
    requirements:
      build:
      - pytester
      run:
      - pytester-run

about:
  homepage: http://matplotlib.org/
  license: PSF-2.0
  license_family: PSF
  license_file:
  - LICENSE/LICENSE
  - LICENSE/LICENSE_AMSFONTS
  - LICENSE/LICENSE_BAKOMA
  - LICENSE/LICENSE_CARLOGO
  - LICENSE/LICENSE_COLORBREWER
  - LICENSE/LICENSE_COURIERTEN
  - LICENSE/LICENSE_JSXTOOLS_RESIZE_OBSERVER
  - LICENSE/LICENSE_QT4_EDITOR
  - LICENSE/LICENSE_SOLARIZED
  - LICENSE/LICENSE_STIX
  - LICENSE/LICENSE_YORICK
  summary: Publication quality figures in Python
