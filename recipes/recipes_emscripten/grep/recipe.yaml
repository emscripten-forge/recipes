context:
  name: grep
  version: '3.12'

package:
  name: ${{ name }}
  version: ${{ version }}

source:
  url: https://ftp.gnu.org/gnu/${{ name }}/${{ name }}-${{ version }}.tar.gz
  sha256: badda546dfc4b9d97e992e2c35f3b5c7f20522ffcbe2f01ba1e9cdcbe7644cdc

build:
  number: 0

requirements:
  build:
  - ${{ compiler("c") }}
  - cmake
  - make
  - autoconf
  - automake
  - gettext
  - gperf
  - pkg-config
  - texinfo

tests:
- package_contents:
    files:
    - bin/grep.js
    - bin/grep.wasm
- script: |
    OUTPUT=$(run_modularized $PREFIX/bin/grep.js --version | head -1)
    if [[ ! "$OUTPUT" =~ "grep (GNU grep) 3.12" ]]; then
      echo "Incorrect output: $OUTPUT"
      exit 1
    fi
  requirements:
    build:
      - run_modularized

about:
  license: GPL-3.0-only
  license_file: COPYING
  summary: |
    Grep searches one or more input files for lines containing a match to a
    specified pattern
  homepage: https://www.gnu.org/software/grep/
  documentation: https://www.gnu.org/software/grep/manual/

extra:
  recipe-maintainers:
  - DerThorsten
  - ianthomas23
