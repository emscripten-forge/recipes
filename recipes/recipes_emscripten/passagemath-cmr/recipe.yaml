context:
  version: 10.8.1

package:
  name: passagemath-cmr
  version: ${{ version }}

source:
- url: https://pypi.org/packages/source/p/passagemath-cmr/passagemath_cmr-${{ version }}.tar.gz
  sha256: 1429150251c554d3457077dc6e73e85a37ec63c5f2f480bfdb65bb33a9ab9d50

build:
  script: ${{ PYTHON }} -m pip install .
  noarch: python

requirements:
  build:
  - python
  - crossenv >=1.2
  - cross-python_emscripten-wasm32
  - ${{ compiler("c") }}
  - ${{ compiler("cxx") }}
  - pip
  - passagemath-setup
  - passagemath-environment
  - cython
  - gmpy2
  - cysignals
  - pkgconfig
  host:
  - python
  - gmp
  - mpfr
  - mpc
  - cmr
  - passagemath-graphs
  - passagemath-modules
  run:
  - python
  - gmpy2
  - cysignals
  - passagemath-graphs
  - passagemath-modules

tests:
- script: pytester
  files:
    recipe:
    - test_passagemath_cmr.py
  requirements:
    build:
    - pytester
    run:
    - pytester-run
    - passagemath-repl

about:
  license: GPL-2.0-or-later
  license_file: README.rst
  summary: 'passagemath: Combinatorial matrix recognition'
  description: "==========================================================================\r\n passagemath: Combinatorial matrix recognition\r\n==========================================================================\r\n\r\n`passagemath <https://github.com/passagemath/passagemath>`__ is open\r\nsource mathematical software in Python, released under the GNU General\r\nPublic Licence GPLv2+.\r\n\r\nIt is a fork of `SageMath <https://www.sagemath.org/>`__, which has been\r\ndeveloped 2005-2026 under the motto “Creating a Viable Open Source\r\nAlternative to Magma, Maple, Mathematica, and MATLAB”.\r\n\r\nThe passagemath fork uses the motto \"Creating a Free Passage Between the\r\nScientific Python Ecosystem and Mathematical Software Communities.\"\r\nIt was created in October 2024 with the following goals:\r\n\r\n-  providing modularized installation with pip from binary wheels,\r\n   - this major project was started in May 2020 in the Sage codebase and completed in passagemath 10.5.29 (May 2025),\r\n\r\n-  establishing first-class membership in the scientific Python\r\n   ecosystem,\r\n\r\n-  giving `clear attribution of upstream\r\n   projects <https://groups.google.com/g/sage-devel/c/6HO1HEtL1Fs/m/G002rPGpAAAJ>`__,\r\n\r\n-  providing independently usable Python interfaces to upstream\r\n   libraries,\r\n\r\n-  offering `platform portability and integration testing\r\n   services <https://github.com/passagemath/passagemath/issues/704>`__\r\n   to upstream projects,\r\n\r\n-  inviting collaborations with upstream projects,\r\n\r\n-  `building a professional, respectful, inclusive\r\n   community <https://groups.google.com/g/sage-devel/c/xBzaINHWwUQ>`__,\r\n\r\n-  `empowering Sage users to participate in the scientific Python ecosystem\r\n   <https://github.com/passagemath/passagemath/issues/248>`__ by publishing packages,\r\n\r\n-  developing a port to WebAssembly (`Pyodide <https://pyodide.org/en/stable/>`__, emscripten-forge) for\r\n   serverless deployment with Javascript,\r\n\r\n-  developing a native Windows port\r\n   - passagemath 10.6.1 (July 2025) published the first pip-installable wheel packages for native Windows on x86_64,\r\n   - passagemath packages became available in the [MSYS2 software distribution](https://packages.msys2.org/search?t=pkg&q=passagemath) in November 2025.\r\n\r\nMoreover, the passagemath project:\r\n\r\n-  provides a stable, frequently updated version of the Sage distribution,\r\n-  integrates additional mathematical software, notably Macaulay2, a full set of GAP packages,\r\n   and the Combinatorial Matrix Recognition library,\r\n-  curates a library of Sage user packages.\r\n\r\n`Full documentation <https://passagemath.org/docs/latest/html/en/index.html>`__ is\r\navailable online.\r\n\r\npassagemath attempts to support and provides binary wheels suitable for\r\nall major Linux distributions and recent versions of macOS.\r\n\r\nBinary wheels for native Windows (x86_64, ARM) are are available for a subset of\r\nthe passagemath distributions. Use of the full functionality of passagemath\r\non Windows currently requires the use of Windows Subsystem for Linux (WSL)\r\nor virtualization.\r\n\r\nThe supported Python versions in the passagemath-10.8.x series are 3.11.x-3.14.x;\r\nthe passagemath-10.6.x series (EOL 2026-10) still supports Python 3.10.x.\r\n\r\n\r\nAbout this pip-installable distribution package\r\n-----------------------------------------------\r\n\r\nThis pip-installable distribution ``passagemath-cmr`` is a small\r\noptional distribution for use with `passagemath-modules <https://pypi.org/project/passagemath-modules/>`_ and\r\n`passagemath-graphs <https://pypi.org/project/passagemath-graphs/>`_.\r\n\r\nIt provides a Cython interface to the\r\n`CMR library <https://github.com/discopt/cmr>`_,\r\nwhich implements recognition and decomposition algorithms for:\r\n\r\n- Totally Unimodular Matrices\r\n- Network Matrices\r\n- Complementary Totally Unimodular Matrices\r\n- (Strongly) Equimodular and Unimodular Matrices\r\n- Regular Matroids\r\n- Graphic / Cographic / Planar Matrices\r\n- Series-Parallel Matroids\r\n\r\n\r\nExamples\r\n--------\r\n\r\n::\r\n\r\n    $ pipx run --pip-args=\"--prefer-binary\" --spec \"passagemath-cmr[test]\" ipython\r\n\r\n    In [1]: from passagemath_cmr import *\r\n\r\n    In [2]: from sage.matrix.matrix_cmr_sparse import Matrix_cmr_chr_sparse\r\n\r\n    In [3]: M = Matrix_cmr_chr_sparse(MatrixSpace(ZZ, 3, 3, sparse=True), [[1, 0, 1], [0, 1, 1], [1, 2, 3]]); M\r\n    Out[3]:\r\n    [1 0 1]\r\n    [0 1 1]\r\n    [1 2 3]\r\n\r\n    In [4]: M.is_unimodular()\r\n    Out[4]: True\r\n\r\n    In [5]: M.is_strongly_unimodular()\r\n    Out[5]: False\r\n\r\n\r\nDevelopment\r\n-----------\r\n\r\n::\r\n\r\n    $ git clone --origin passagemath https://github.com/passagemath/passagemath.git  # or use your fork\r\n    $ cd passagemath\r\n    passagemath $ ./bootstrap\r\n    passagemath $ source ./.homebrew-build-env         # on macOS when homebrew is in use\r\n    passagemath $ export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/wsl/lib  # on WSL\r\n    passagemath $ export PIP_CONSTRAINT=\"$(pwd)/constraints_cmr.txt\"\r\n    passagemath $ export PIP_BUILD_CONSTRAINT=\"$(pwd)/constraints_cmr.txt\"\r\n    passagemath $ echo \"passagemath-categories @ file://$(pwd)/pkgs/sagemath-categories\" >> constraints_cmr.txt\r\n    passagemath $ echo \"passagemath-modules @ file://$(pwd)/pkgs/sagemath-modules\" >> constraints_cmr.txt\r\n    passagemath $ python3 -m venv cmr-venv\r\n    passagemath $ source cmr-venv/bin/activate\r\n    (cmr-venv) passagemath $ pip install -v -e pkgs/sagemath-cmr        \\\r\n                                            -e pkgs/sagemath-modules    \\\r\n                                            -e pkgs/sagemath-categories\r\n\r\nModularized use::\r\n\r\n    (cmr-venv) passagemath $ pip install -v passagemath-repl\r\n    (cmr-venv) passagemath $ sage\r\n    ... sage.all is not available ...\r\n    sage: from passagemath_modules import *\r\n    sage: matroids.Uniform(3, 4)\r\n    U(3, 4): Matroid of rank 3 on 4 elements with circuit-closures\r\n    {3: {{0, 1, 2, 3}}}\r\n\r\nIn plain Python::\r\n\r\n    (cmr-venv) passagemath $ python3\r\n    >>> from passagemath_modules import *\r\n    >>> matroids.Uniform(3, 4)\r\n    U(3, 4): Matroid of rank 3 on 4 elements with circuit-closures\r\n    {3: {{0, 1, 2, 3}}}\r\n\r\nFor full functionality of Sage::\r\n\r\n    (cmr-venv) passagemath $ pip install -v passagemath-standard\r\n    (cmr-venv) passagemath $ sage\r\n    sage: matroids.Uniform(3, 4)\r\n    U(3, 4): Matroid of rank 3 on 4 elements with circuit-closures\r\n    {3: {{0, 1, 2, 3}}}\r\n"

extra:
  emscripten_tests:
    python:
      pytest_files:
      - test_passagemath_cmr.py
  recipe-maintainers:
  - mkoeppe
