context:
  name: scipy
  version: 1.15.3

package:
  name: ${{ name }}
  version: ${{ version }}

source:
- url: https://pypi.org/packages/source/s/scipy/scipy-${{ version }}.tar.gz
  sha256: eae3cf522bc7df64b42cad3925c876e1b0b6c35c1337c93e12c0f366f55b0eaf
  patches:
  - patches/0001-Remove-duplicate-symbol.patch
  - patches/0002-Set-fortran-linker-to-emcc.patch
  - patches/0003-Disable-threads.patch
  - patches/0004-Replace-dtype-with-numpy-int32.patch
  - patches/0005-Remove-unsupported-version-script.patch
  - patches/0006-Dont-import-numpy-f2py-in-tests.patch
    # Branch containing following patches is v1.15.2-emforge-4x at https://github.com/ianthomas23/scipy
    # Use `git format-patch v1.15.2...HEAD --start-number 7`
  - patches/0007-Remove-chla_transtype.patch
  - patches/0008-Extra-char-length-arguments-in-linalg-cython-wrapper.patch
  - patches/0009-Change-return-and-char-length-args-in-dsolve.patch
  - patches/0010-Change-return-and-char-length-args-in-optimize.patch
  - patches/0011-int-return-for-superlu_utils-and-input_error.patch
  - patches/0012-Extra-char-length-args-to-f2py-source-files.patch
  - patches/0013-Change-arg-type-in-odepack.patch
  - patches/0014-Make-sf_error_state-a-static-library.patch
  - patches/0015-Use-openblas-flang-not-openblas-dependency.patch

build:
  number: 1

  files:
    exclude:
    - '**/*.pyi'
    - '**/tests/**'
    - '**/*.pxd'
    - '**.dist-info/**'
    - '**/*.pyx'
    - '**/__pycache__/**'
    - '**/*.pyc'
    - '**/test_*.py'
  python:
    skip_pyc_compilation:
    - '**/*.py'
requirements:
  build:
  - ${{ compiler('c') }}
  - ${{ compiler('cxx') }}
  - python
  - cross-python_${{ target_platform }}
  - cython
    # - llvm_${{ target_platform }} # Installing custom LLVM in build.sh
  - meson-python
  - numpy
  - pkg-config
  host:
  - numpy
  - openblas-flang
  - pybind11
  - python
  run:
  - python
  - numpy
  - openblas-flang

tests:
- dummy-to-avoiding-linting-error:
#- script: pytester
#  files:
#    recipe:
#    - test_scipy.py
#  requirements:
#    build:
#    - pytester
#    run:
#    - pytester-run

about:
  homepage: http://www.scipy.org/
  license: BSD-3-Clause
  license_file: LICENSE.txt
  summary: Scientific Library for Python
  description: |
    SciPy is a Python-based ecosystem of open-source software for mathematics,
    science, and engineering.

extra:
  maintainers:
  - ianthomas23
