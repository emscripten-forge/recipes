From 41d857470b3d20a9a6e12151766439fd2f8b91a0 Mon Sep 17 00:00:00 2001
From: Isabel Paredes <isabel.paredes@quantstack.net>
Date: Mon, 15 Sep 2025 18:43:30 +0200
Subject: [PATCH] Use prefix dirs

---
 libheif/libheif_build.py | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/libheif/libheif_build.py b/libheif/libheif_build.py
index b6dcc87..3f73d84 100644
--- a/libheif/libheif_build.py
+++ b/libheif/libheif_build.py
@@ -7,8 +7,13 @@ ffibuilder = FFI()
 with open("libheif/libheif_api.h") as f:
     ffibuilder.cdef(f.read())
 
-include_dirs = ["/usr/local/include", "/usr/include", "/opt/local/include"]
-library_dirs = ["/usr/local/lib", "/usr/lib", "/lib", "/opt/local/lib"]
+include_dirs = []
+library_dirs = []
+
+cross_prefix = os.getenv("PREFIX")
+if cross_prefix:
+    include_dirs.append(os.path.join(cross_prefix, "include"))
+    library_dirs.append(os.path.join(cross_prefix, "lib"))
 
 homebrew_prefix = os.getenv("HOMEBREW_PREFIX")
 if homebrew_prefix:
