From 4c7c08bcbd9f3f1c0c7066f8385b012332423cd8 Mon Sep 17 00:00:00 2001
From: Isabel Paredes <isabel.paredes@quantstack.net>
Date: Tue, 6 Aug 2024 17:10:17 +0200
Subject: [PATCH] Use basenames for compilers

---
 Makeconf.in     |  6 +++---
 etc/Makeconf.in | 24 ++++++++++++------------
 2 files changed, 15 insertions(+), 15 deletions(-)

diff --git a/Makeconf.in b/Makeconf.in
index 59b8d7c..7a7a1c9 100644
--- a/Makeconf.in
+++ b/Makeconf.in
@@ -6,21 +6,21 @@ abs_top_builddir = @abs_top_builddir@
 
 include $(top_srcdir)/share/make/vars.mk
 
-AR = @AR@
+AR = emar
 ACLOCAL = @ACLOCAL@
 AUTOCONF = @AUTOCONF@
 AUTOMAKE = @AUTOMAKE@
 AUTOHEADER = @AUTOHEADER@
 BLAS_LIBS = @BLAS_LIBS@
 BUILDDIR_IS_SRCDIR = @BUILDDIR_IS_SRCDIR@
-CC = @CC@
+CC = emcc
 CFLAGS = @CFLAGS@ @LTO@
 CPICFLAGS = @CPICFLAGS@
 CPPFLAGS = @CPPFLAGS@
 CURL_CPPFLAGS = @CURL_CPPFLAGS@
 CURL_LIBS = @CURL_LIBS@
 ## in case we want to link with this for UBSAN checks
-CXX = @CXX@
+CXX = $(basename @CXX@)
 ## DEFS is generated by autoconf as -DHAVE_CONFIG_H: R_DEFS is user's
 DEFS = @DEFS@ @R_DEFS@
 DISTDIR_TAR_EXCLUDE = --exclude=.svn --exclude=Makefile --exclude="*.o" --exclude="*$(SHLIB_EXT)" --exclude="*~"
diff --git a/etc/Makeconf.in b/etc/Makeconf.in
index d84a912..a94ae0f 100644
--- a/etc/Makeconf.in
+++ b/etc/Makeconf.in
@@ -9,45 +9,45 @@
 ## This fails if it contains spaces, or if it is quoted
 include $(R_SHARE_DIR)/make/vars.mk
 
-AR = @AR@
+AR = $(basename @AR@)
 BLAS_LIBS = @BLAS_LIBS@
 
 ## C compilers
-CC = @CC@
+CC = emcc
 CFLAGS = @CFLAGS@ $(LTO)
-CC17 = @CC17@
+CC17 = emcc
 C17FLAGS = @C17FLAGS@ $(LTO)
-CC23 = @CC23@
+CC23 = emcc
 C23FLAGS = @C23FLAGS@ $(LTO)
-CC90 = @CC90@
+CC90 = emcc
 C90FLAGS = @C90FLAGS@ $(LTO)
-CC99 = @CC99@
+CC99 = emcc
 C99FLAGS = @C99FLAGS@ $(LTO)
 CPICFLAGS = @CPICFLAGS@
 CPPFLAGS = @CPPFLAGS@
 C_VISIBILITY = @C_VISIBILITY@
 
 ## C++ compilers
-CXX = @CXX@ @CXXSTD@
+CXX = $(basename @CXX@) @CXXSTD@
 CXXFLAGS = @CXXFLAGS@ $(LTO)
 CXXPICFLAGS = @CXXPICFLAGS@
-CXX11 = @CXX11@
+CXX11 = $(basename @CXX11@)
 CXX11FLAGS = @CXX11FLAGS@ $(LTO)
 CXX11PICFLAGS = @CXX11PICFLAGS@
 CXX11STD = @CXX11STD@
-CXX14 = @CXX14@
+CXX14 = $(basename @CXX14@)
 CXX14FLAGS = @CXX14FLAGS@ $(LTO)
 CXX14PICFLAGS = @CXX14PICFLAGS@
 CXX14STD = @CXX14STD@
-CXX17 = @CXX17@
+CXX17 = $(basename @CXX17@)
 CXX17FLAGS = @CXX17FLAGS@ $(LTO)
 CXX17PICFLAGS = @CXX17PICFLAGS@
 CXX17STD = @CXX17STD@
-CXX20 = @CXX20@
+CXX20 = $(basename @CXX20@)
 CXX20FLAGS = @CXX20FLAGS@ $(LTO)
 CXX20PICFLAGS = @CXX20PICFLAGS@
 CXX20STD = @CXX20STD@
-CXX23 = @CXX23@
+CXX23 = $(basename @CXX23@)
 CXX23FLAGS = @CXX23FLAGS@ $(LTO)
 CXX23PICFLAGS = @CXX23PICFLAGS@
 CXX23STD = @CXX23STD@
