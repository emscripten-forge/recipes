context:
  name: pycalphad
  version: 0.11.1

package:
  name: ${{ name }}
  version: ${{ version }}

source:
  url: https://pypi.io/packages/source/${{ name[0] }}/${{ name }}/${{ name }}-${{ version }}.tar.gz
  sha256: 57b5c8618d7168c02648b99de6545b24dd60591f96bcc3fd2a260e57663e727e

build:
  number: 0
  script: ${PYTHON} -m pip install .

requirements:
  build:
    - cross-python_${{ target_platform }}
    - ${{ compiler('cxx') }}
    - python
    - cython
    - numpy>=2.0
    - setuptools-scm
    - scipy
    - pip
  host:
    - python
  run:
    - matplotlib
    - numpy
    - pint
    - pyparsing
    - pytest
    - python-symengine
    - runtype
    - scipy
    - tinydb
    - typing-extensions # drop when pycalphad drops support for Python<3.13
    - xarray

tests:
- script: echo "FIXME:"
# The tests for v0.11.0 pass. This package has been tested with xeus-python.
# The following fails because of issues with the test environment.
# See https://github.com/emscripten-forge/recipes/issues/4364
# tests:
#   - script: pytester
#     requirements:
#       build:
#         - pytester
#       run:
#         - pytester-run
#     files:
#       recipe:
#         - test_pycalphad.py

about:
  homepage: https://pycalphad.org/
  license: MIT
  license_file: LICENSE.txt
  summary: CALPHAD tools for designing thermodynamic models, calculating phase diagrams and investigating phase equilibria.
  description: |
    pycalphad is a free and open-source Python library for designing thermodynamic models, calculating phase diagrams and investigating phase equilibria within the CALPHAD method.
  documentation: https://pycalphad.org/
  repository: https://github.com/pycalphad/pycalphad

extra:
  recipe-maintainers:
  - richardotis
  - bocklund

