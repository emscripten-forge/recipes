context:
  name: emscripten_emscripten-wasm32
  version: 4.0.9
  abi_version: 4.0.9

build:
  number: 6

outputs:
  - package:
      name: ${{ name }}
      version: ${{ version }}

    source:
      git: https://github.com/emscripten-core/emsdk.git

    build:
      script: build_compiler_package.sh

      dynamic_linking:
        binary_relocation: false

    requirements:
      build:
        - curl
        - python >=3.13
        - gettext-tools
        - xz
        - tar
        - patch  # Used in ./build.sh script
      run:
        - python >=3.13
        - nodejs >=22
      run_exports:
        strong:
          - ${{ pin_subpackage('emscripten-abi', lower_bound='x', upper_bound='x') }}

    tests:
    - script: emcc -v


  - package:
      name: emscripten-abi
      version: ${{ abi_version }}

    build:
      noarch: generic
      script:
        - echo "emscripten abi is built."

    tests:
    - script: echo "Empty package."


about:
  homepage: https://emscripten.org
  license: MIT
  license_file: LICENSE.txt
  summary: emscripten
  description: |
    Emscripten is a complete compiler toolchain to WebAssembly, using LLVM, with
    a special focus on speed, size, and the Web platform.
  documentation: https://emscripten.org/

extra:
  recipe-maintainers:
    - DerThorsten
    - wolfv
